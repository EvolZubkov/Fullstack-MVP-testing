# SCORM Test Constructor

## Обзор

Веб-приложение для создания учебных тестов с экспортом в SCORM 2004 для интеграции с LMS. Авторы создают банки вопросов, сгруппированные по темам, собирают тесты с настраиваемыми критериями прохождения и экспортируют SCORM-пакеты. Учащиеся проходят тесты и получают детальные результаты с разбивкой по темам и рекомендациями курсов.

## Предпочтения пользователя

Предпочитаемый стиль общения: простой, повседневный язык.

## Архитектура системы

### Архитектура фронтенда
- **Фреймворк**: React с TypeScript, сборка через Vite
- **Маршрутизация**: Wouter для лёгкого client-side роутинга
- **Управление состоянием**: TanStack React Query для server state
- **UI-компоненты**: библиотека shadcn/ui на примитивах Radix UI
- **Стили**: Tailwind CSS с кастомными дизайн-токенами, поддержка тёмной/светлой темы
- **Формы**: React Hook Form + валидация через Zod

### Архитектура бэкенда
- **Runtime**: Node.js с Express
- **Язык**: TypeScript с ES modules
- **Сессии**: Express sessions с MemoryStore (dev) или connect-pg-simple (prod)
- **Аутентификация**: cookie-сессии + хэширование паролей через bcrypt

### Слой данных
- **ORM**: Drizzle ORM с диалектом PostgreSQL
- **Схема**: `shared/schema.ts` содержит все таблицы базы данных
- **Миграции**: Drizzle Kit для миграций схемы (`drizzle-kit push`)

### Ролевой доступ
- **Автор**: управляет темами, вопросами, тестами и экспортом SCORM
- **Учащийся**: проходит тесты и смотрит результаты

### Типы вопросов
1. Один вариант — один правильный ответ
2. Несколько вариантов — несколько правильных ответов (требуется точное совпадение)
3. Сопоставление — сопоставить элементы слева и справа
4. Ранжирование — упорядочить элементы правильно

### Возможности вопросов
- **Перемешивание ответов**: у каждого вопроса есть флаг `shuffleAnswers` (по умолчанию true). Если включён, варианты ответов показываются в случайном порядке во время прохождения теста, при этом корректность ответов сохраняется.
- **Дублирование**: вопросы и темы (вместе со всеми вопросами) можно дублировать для быстрого создания контента.
- **Импорт/экспорт Excel**: вопросы можно экспортировать в XLSX и импортировать из XLSX с колонками: Тема, Тип вопроса, Текст вопроса, Балл, Тексты вариантов ответа (# separated), Номера правильных ответов, Следование вариантов ответов (Random/empty).
- **Массовое удаление**: можно выбрать несколько вопросов чекбоксами и удалить одним действием.
- **Обратная связь**: опциональный текст feedback можно добавлять к вопросам, темам и тестам. Он показывается в результатах после ответа.
- **Каскадное удаление**: удаление темы автоматически удаляет все её вопросы и связанные курсы.

### Структура теста
- Тесты состоят из секций, каждая связана с темой
- В каждой секции задаётся, сколько вопросов случайно выбрать
- Правила прохождения можно задавать по темам и для теста в целом (проценты или абсолютное количество)
- Попытки теста сохраняют сгенерированный вариант и ответы учащегося

### Экспорт SCORM
- Генерируются пакеты, совместимые с SCORM 2004 4th Edition
- Для создания ZIP используется библиотека Archiver
- Включаются manifest, metadata и runtime JavaScript
- В LMS отправляются: балл (score), завершение (completion), успешность (success), а также взаимодействия (interactions) по темам

### Система сборки
- Разработка: Vite dev server с HMR, tsx для бэкенда
- Продакшен: Vite собирает фронтенд в `dist/public`, esbuild бандлит сервер в `dist/index.cjs`

## Внешние зависимости

### База данных
- PostgreSQL (настраивается через переменную окружения `DATABASE_URL`)
- Drizzle ORM для типобезопасных запросов

### Аутентификация
- bcryptjs для хэширования паролей
- express-session для управления сессиями

### UI-фреймворк
- Примитивы Radix UI для доступных компонентов
- Tailwind CSS для стилизации
- Google Fonts (Inter, JetBrains Mono)

### Генерация файлов
- Archiver для создания SCORM ZIP-пакетов

### Инструменты разработки
- Replit-специфичные плагины Vite для error overlay и cartographer
- TypeScript для проверки типов
